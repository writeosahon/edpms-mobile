{"version":3,"sources":["controller.js"],"names":[],"mappings":"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","file":"controller-compiled.js","sourcesContent":["/**\r\n * Created by UTOPIA SOFTWARE on 26/7/2018.\r\n */\r\n\r\n/**\r\n * file defines all View-Models, Controllers and Event Listeners used by the app\r\n *\r\n * The 'utopiasoftware_app_namespace' namespace variable has being defined in the base js file.\r\n * The author uses the terms 'method' and function interchangeably; likewise the terms 'attribute' and 'property' are\r\n * also used interchangeably\r\n */\r\n\r\n// define the controller namespace\r\nutopiasoftware[utopiasoftware_app_namespace].controller = {\r\n\r\n    /**\r\n     * property holds the Map objects which will contain a reference to dynamically loaded ES modules.\r\n     * NOTE: modules MUST BE deleted from this property i.e. the Map object when no longer need.\r\n     * This is to enable garbage collection and prevent memory leaks.\r\n     * NOTE: the keys used within the map will be identical to the same map value used in the SystemJS.config()\r\n     */\r\n    LOADED_MODULES: new Map(),\r\n    /**\r\n     * method contains the stratup/bootstrap code needed to initiate app logic execution\r\n     */\r\n    startup: function(){\r\n\r\n        // initialise the app libraries and plugins\r\n        ons.ready(async function () {\r\n            // set the default handler for the app\r\n            ons.setDefaultDeviceBackButtonListener(function(){\r\n                // does nothing for now!!\r\n            });\r\n\r\n            // displaying prepping message\r\n            $('#loader-modal-message').html(\"Loading App...\");\r\n            $('#loader-modal').get(0).show(); // show loader\r\n\r\n\r\n            if(window.localStorage.getItem(\"utopiasoftware-edpms-app-status\") &&\r\n                window.localStorage.getItem(\"utopiasoftware-edpms-app-status\") !== \"\"){ // there is a previous logged in user\r\n                // load the app main page\r\n                $('ons-splitter').get(0).content.load(\"app-main-template\");\r\n            }\r\n            else{ // there is no previously logged in user\r\n                // load the login page\r\n                $('ons-splitter').get(0).content.load(\"login-template\");\r\n            }\r\n\r\n            // START ALL CORDOVA PLUGINS CONFIGURATIONS\r\n            try{\r\n                // lock the orientation of the device to 'PORTRAIT'\r\n                screen.orientation.lock('portrait');\r\n            }\r\n            catch(err){}\r\n\r\n            try { // START ALL THE CORDOVA PLUGINS CONFIGURATION WHICH REQUIRE PROMISE SYNTAX\r\n\r\n                // prepare the inapp browser plugin by removing the default window.open() functionality\r\n                delete window.open;\r\n\r\n                // note: for most promises, we will use async-wait syntax\r\n\r\n                // create the pouchdb app database\r\n                utopiasoftware[utopiasoftware_app_namespace].model.appDatabase = new PouchDB('ptrackerdatabase.db', {\r\n                    adapter: 'cordova-sqlite',\r\n                    location: 'default',\r\n                    androidDatabaseImplementation: 2\r\n                });\r\n\r\n                // generate a password for encrypting the app database (if it does NOT already exist)\r\n                if(!window.localStorage.getItem(\"utopiasoftware-edpms-rid\") ||\r\n                    window.localStorage.getItem(\"utopiasoftware-edpms-rid\") === \"\") {\r\n                    window.localStorage.setItem(\"utopiasoftware-edpms-rid\",\r\n                        Random.uuid4(Random.engines.browserCrypto));\r\n                }\r\n                await new Promise(function(resolve, reject){\r\n                    utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.\r\n                    crypto(window.localStorage.getItem(\"utopiasoftware-edpms-rid\"), {ignore: '_attachments',\r\n                        cb: function(err, key){\r\n                        if(err){ // there is an error\r\n                            reject(err); // reject Promise\r\n                        }\r\n                        else{ // no error\r\n                            resolve(key); // resolve Promise\r\n                        }\r\n                    }});\r\n                });\r\n\r\n                // create the database indexes used by the app\r\n                await Promise.all([utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.createIndex({\r\n                    index: {\r\n                        fields: ['TYPE'],\r\n                        name: 'DOC_TYPE_INDEX',\r\n                        ddoc: 'ptracker-index-designdoc'\r\n                    }}),\r\n                    utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.createIndex({\r\n                        index: {\r\n                            fields: ['PROJECTID', 'TYPE'],\r\n                            name: 'FIND_PROJECT_BY_ID_INDEX',\r\n                            ddoc: 'ptracker-index-designdoc'\r\n                        }\r\n                    })]);\r\n\r\n            }\r\n            catch(err){\r\n                console.log(\"ERROR\");\r\n            }\r\n            finally{\r\n                 // set status bar color\r\n                 StatusBar.backgroundColorByHexString(\"#00B2A0\");\r\n                 navigator.splashscreen.hide(); // hide the splashscreen\r\n                 utopiasoftware[utopiasoftware_app_namespace].model.isAppReady = true; // flag that app is fullyt loaded and ready\r\n            }\r\n\r\n        }); // end of ons.ready()\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * this is the view-model/controller for the LOGIN page\r\n     */\r\n    loginPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the sign-in page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            async function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware[utopiasoftware_app_namespace].model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#login-navigator').get(0).topPage.onDeviceBackButton = function(){\r\n                    ons.notification.confirm('Do you want to close the app?', {title: 'Exit App',\r\n                        buttonLabels: ['No', 'Yes'], modifier: 'utopiasoftware-alert-dialog'}) // Ask for confirmation\r\n                        .then(function(index) {\r\n                            if (index === 1) { // OK button\r\n                                navigator.app.exitApp(); // Close the app\r\n                            }\r\n                        });\r\n                };\r\n\r\n                // adjust the window/view-port settings for when the soft keyboard is displayed\r\n                //window.SoftInputMode.set('adjustPan'); // let the window/view-port 'pan' when the soft keyboard is displayed\r\n                window.SoftInputMode.set('adjustResize');\r\n\r\n                // initialise the login form validation\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidator =\r\n                    $('#login-form').parsley();\r\n\r\n                // listen for log in form field validation failure event\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for log in form field validation success event\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                });\r\n\r\n                // listen for log in form validation success\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidated);\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n                //$('#determinate-progress-modal').get(0).show();\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // adjust the window/view-port settings for when the soft keyboard is displayed\r\n            window.SoftInputMode.set('adjustResize'); // let the window/view-port 'pan' when the soft keyboard is displayed\r\n\r\n            // listen for when the device keyboard is hidden\r\n            window.addEventListener(\"keyboardDidHide\", utopiasoftware[utopiasoftware_app_namespace].\r\n                controller.loginPageViewModel.keyboardHidden);\r\n\r\n            // listen for when the device keyboard is shown\r\n            window.addEventListener(\"keyboardDidShow\", utopiasoftware[utopiasoftware_app_namespace].\r\n                controller.loginPageViewModel.keyboardShown);\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            // adjust the window/view-port settings for when the soft keyboard is displayed\r\n            // window.SoftInputMode.set('adjustResize'); // let the view 'resize' when the soft keyboard is displayed\r\n\r\n            try {\r\n                // remove the listeners registered to listen for when the device keyboard is hidden and shown\r\n                window.removeEventListener(\"keyboardDidHide\", utopiasoftware[utopiasoftware_app_namespace].\r\n                    controller.loginPageViewModel.keyboardHidden);\r\n                window.addEventListener(\"keyboardDidShow\", utopiasoftware[utopiasoftware_app_namespace].\r\n                    controller.loginPageViewModel.keyboardShown);\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#login-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#login-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#login-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#login-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidator.destroy();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method will be triggered when the device keyboard is hidden. This is an event listener\r\n         */\r\n        keyboardHidden(){\r\n            // show the title banner on the home page\r\n            $('#login-page .login-title-banner').css(\"display\", \"block\");\r\n        },\r\n\r\n        /**\r\n         * method will be triggered when the device keyboard is shown. This is an event listener\r\n         */\r\n        keyboardShown(){\r\n            // hide the title banner on the home page\r\n            $('#login-page .login-title-banner').css(\"display\", \"none\");\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the \"Sign In / Log In\" button is clicked\r\n         *\r\n         * @returns {Promise<void>}\r\n         */\r\n        async loginButtonClicked(){\r\n\r\n            // run the validation method for the sign-in form\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.loginPageViewModel.formValidator.whenValidate();\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the enter button is clicked on the device keyboard\r\n         *\r\n         * @param keyEvent\r\n         * @returns {Promise<void>}\r\n         */\r\n        async enterButtonClicked(keyEvent){\r\n            // check which key was pressed\r\n            if(keyEvent.which === kendo.keys.ENTER) // if the enter key was pressed\r\n            {\r\n                // prevent the default action from occurring\r\n                keyEvent.preventDefault();\r\n                keyEvent.stopImmediatePropagation();\r\n                keyEvent.stopPropagation();\r\n                // hide the device keyboard\r\n                Keyboard.hide();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the form is successfully validated\r\n         *\r\n         * @returns {Promise<void>}\r\n         */\r\n        async formValidated(){\r\n\r\n            // check if Internet Connection is available before proceeding\r\n            if(navigator.connection.type === Connection.NONE){ // no Internet Connection\r\n                // inform the user that they cannot proceed without Internet\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"You cannot sign in without an Internet Connection\",\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n\r\n                return; // exit method immediately\r\n            }\r\n\r\n            // inform user that login validation is taking place\r\n            $('#loader-modal #loader-modal-message').html(\"Signing You In...\");\r\n            await $('#loader-modal').get(0).show();\r\n\r\n            try{\r\n                // create the form data to be submitted\r\n                let formData = {\r\n                    username: $('#login-page #login-email').val().trim(),\r\n                    password: $('#login-page #login-password').val().trim()\r\n                };\r\n\r\n                let serverResponse = await Promise.resolve($.ajax(\r\n                    {\r\n                        url: utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl + \"/mobile/login.php\",\r\n                        type: \"post\",\r\n                        contentType: \"application/x-www-form-urlencoded\",\r\n                        beforeSend: function(jqxhr) {\r\n                            jqxhr.setRequestHeader(\"X-PTRACKER-APP\", \"mobile\");\r\n                        },\r\n                        dataType: \"text\",\r\n                        timeout: 240000, // wait for 4 minutes before timeout of request\r\n                        processData: true,\r\n                        data: formData\r\n                    }\r\n                ));\r\n                // convert the response to an object\r\n                serverResponse = JSON.parse(serverResponse.trim());\r\n\r\n                // check if the user login was successful\r\n                if(serverResponse.status !== \"success\"){ // user log was NOT successful\r\n                    throw serverResponse; // throw error\r\n                }\r\n\r\n                // save the user's details\r\n                utopiasoftware[utopiasoftware_app_namespace].model.userDetails = {\r\n                    _id: \"userDetails\",\r\n                    userDetails: {firstname: serverResponse.firstname, username: serverResponse.username},\r\n                    type: \"userDetails\",\r\n                    _rev: (window.localStorage.getItem(\"utopiasoftware-edpms-app-status\") &&\r\n                        window.localStorage.getItem(\"utopiasoftware-edpms-app-status\") !== \"\") ?\r\n                        window.localStorage.getItem(\"utopiasoftware-edpms-app-status\") : null\r\n                };\r\n\r\n                // check if the user wants to remain signed in\r\n                if($('#login-page #login-remember-me').get(0).checked){ // the user wants to remian signed in\r\n                    // save the user's details to persistent database\r\n                    let databaseResponse = await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.put(\r\n                        utopiasoftware[utopiasoftware_app_namespace].model.userDetails);\r\n                    // save the returned user details rev id\r\n                    window.localStorage.setItem(\"utopiasoftware-edpms-app-status\", databaseResponse.rev);\r\n                }\r\n                else{ // user does not want to remain signed in\r\n                    // remove the user details rev id from storage\r\n                    window.localStorage.removeItem(\"utopiasoftware-edpms-app-status\");\r\n                }\r\n\r\n                // flag that the user just completed a sign in for this session\r\n                window.sessionStorage.setItem(\"utopiasoftware-edpms-user-logged-in\", \"yes\");\r\n\r\n                // move user to the main menu page\r\n                await Promise.all([$('ons-splitter').get(0).content.load(\"app-main-template\"),\r\n                    $('#loader-modal').get(0).hide()]);\r\n                // display a toast to the user\r\n                //ons.notification.toast(`<ons-icon icon=\"md-check\" size=\"20px\" style=\"color: #00D5C3\"></ons-icon> Welcome ${serverResponse.firstname}`, {timeout:3000});\r\n            }\r\n            catch(err){\r\n                $('#loader-modal').get(0).hide();\r\n                ons.notification.alert(err.message, {title: '<span style=\"color: red\">Sign In Failed</span>',\r\n                    buttonLabels: ['OK'], modifier: 'utopiasoftware-alert-dialog'});\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * this is the view-model/controller for the Search Project page\r\n     */\r\n    searchProjectPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the sign-in page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * object holds the currently searched and chosen project object\r\n         */\r\n        currentlySelectedProject: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            async function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware[utopiasoftware_app_namespace].model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.backButtonClicked;\r\n\r\n                // initialise the login form validation\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.formValidator =\r\n                    $('#search-project-form').parsley();\r\n\r\n                // listen for log in form field validation failure event\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.formValidator.on('field:error', function(fieldInstance) {\r\n                    // get the element that triggered the field validation error and use it to display tooltip\r\n                    // display tooltip\r\n                    $(fieldInstance.$element).addClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).attr(\"data-hint\", fieldInstance.getErrorsMessages()[0]);\r\n                });\r\n\r\n                // listen for log in form field validation success event\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.\r\n                formValidator.on('field:success', function(fieldInstance) {\r\n                    // remove tooltip from element\r\n                    $(fieldInstance.$element).removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                    $(fieldInstance.$element).removeAttr(\"data-hint\");\r\n                });\r\n\r\n                // listen for log in form validation success\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.formValidator.on('form:success',\r\n                    utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.formValidated);\r\n\r\n                try{\r\n                    // keep device awake during the downloading process\r\n                    window.plugins.insomnia.keepAwake();\r\n                    // check if the user just completed a signin or log-in\r\n                    if(window.sessionStorage.getItem(\"utopiasoftware-edpms-user-logged-in\") === \"yes\") {\r\n                        // beginning uploading app data\r\n                        $('#determinate-progress-modal .modal-message').html('Downloading projects data for offline use...');\r\n                        $('#determinate-progress-modal').get(0).show();\r\n                        $('#determinate-progress-modal #determinate-progress').get(0).value = 30;\r\n\r\n                        // get the projects data to be cached\r\n                        let serverResponse = await Promise.resolve($.ajax(\r\n                            {\r\n                                url: utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl + \"/mobile/loadprojects.php\",\r\n                                type: \"post\",\r\n                                contentType: \"application/x-www-form-urlencoded\",\r\n                                beforeSend: function(jqxhr) {\r\n                                    jqxhr.setRequestHeader(\"X-PTRACKER-APP\", \"mobile\");\r\n                                },\r\n                                dataType: \"text\",\r\n                                timeout: 240000, // wait for 4 minutes before timeout of request\r\n                                processData: true,\r\n                                data: {}\r\n                            }\r\n                        ));\r\n\r\n                        serverResponse = JSON.parse(serverResponse); // convert the response to JSON object\r\n\r\n                        $('#determinate-progress-modal #determinate-progress').get(0).value = 35;\r\n\r\n                        // delete all previous project data/docs\r\n                        let allProjects = await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.find({\r\n                            selector: {\r\n                                \"TYPE\": {\r\n                                    \"$eq\": \"projects\"\r\n                                }},\r\n                            fields: [\"_id\", \"_rev\", \"PROJECTID\", \"TITLE\", \"CONTRACTSUM\", \"CONTRACTOR\", \"MDAID\", \"TYPE\"],\r\n                            use_index: [\"ptracker-index-designdoc\", \"DOC_TYPE_INDEX\"]\r\n                        });\r\n\r\n                        // get all the returned projects and delete them\r\n                        allProjects = allProjects.docs.map((currentValue, index, array) => {\r\n                            currentValue._deleted = true; // mark the document as deleted\r\n                            return currentValue;\r\n                        });\r\n\r\n                        // check if there are any project data to delete\r\n                        if(allProjects.length > 0){\r\n                            // delete the already saved projects\r\n                            await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.bulkDocs(allProjects);\r\n                        }\r\n\r\n                        $('#determinate-progress-modal #determinate-progress').get(0).value = 45;\r\n\r\n                        // store the all the project data received\r\n                        await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.bulkDocs(serverResponse);\r\n                        // inform the user that milestone data is being downloaded for offline use\r\n                        $('#determinate-progress-modal .modal-message').html('Downloading milestones data for offline use...');\r\n\r\n                        $('#determinate-progress-modal #determinate-progress').get(0).value = 50;\r\n\r\n                        // get the milestones data to be cached\r\n                        serverResponse = await Promise.resolve($.ajax(\r\n                            {\r\n                                url: utopiasoftware[utopiasoftware_app_namespace].model.appBaseUrl + \"/mobile/loadboq.php\",\r\n                                type: \"post\",\r\n                                contentType: \"application/x-www-form-urlencoded\",\r\n                                beforeSend: function(jqxhr) {\r\n                                    jqxhr.setRequestHeader(\"X-PTRACKER-APP\", \"mobile\");\r\n                                },\r\n                                dataType: \"text\",\r\n                                timeout: 240000, // wait for 4 minutes before timeout of request\r\n                                processData: true,\r\n                                data: {}\r\n                            }\r\n                        ));\r\n\r\n                        serverResponse = JSON.parse(serverResponse); // convert the response to JSON object\r\n\r\n                        $('#determinate-progress-modal #determinate-progress').get(0).value = 75;\r\n\r\n                        // delete all previous milestones /docs\r\n                        allProjects = await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.find({\r\n                            selector: {\r\n                                \"TYPE\": {\r\n                                    \"$eq\": \"BOQ\"\r\n                                }},\r\n                            fields: [\"_id\", \"_rev\", \"CATEGORY\", \"AMOUNT\", \"RATE\", \"PROJECTID\", \"DDATE\", \"BOQID\", \"TYPE\"],\r\n                            use_index: [\"ptracker-index-designdoc\", \"DOC_TYPE_INDEX\"]\r\n                        });\r\n\r\n                        // get all the returned milestones and delete them\r\n                        allProjects = allProjects.docs.map((currentValue, index, array) => {\r\n                            currentValue._deleted = true; // mark the document as deleted\r\n                            return currentValue;\r\n                        });\r\n\r\n                        // check if there are any milestone data to delete\r\n                        if(allProjects.length > 0){\r\n                            // delete the already saved milestone data\r\n                            await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.bulkDocs(allProjects);\r\n                        }\r\n\r\n                        $('#determinate-progress-modal #determinate-progress').get(0).value = 100;\r\n\r\n                        // store the all the milestone data received\r\n                        await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.bulkDocs(serverResponse);\r\n                    }\r\n\r\n                    // check if the user just completed a signin or log-in\r\n                    if(window.sessionStorage.getItem(\"utopiasoftware-edpms-user-logged-in\") !== \"yes\") { // user did NOT just log in / sign in\r\n                        // get the userDetails data from the app database\r\n                        utopiasoftware[utopiasoftware_app_namespace].model.userDetails =\r\n                            (await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.get(\"userDetails\"));\r\n                    }\r\n\r\n                    // hide the progress loader\r\n                    await Promise.all([$('#determinate-progress-modal').get(0).hide(),\r\n                        $('#loader-modal').get(0).hide()]);\r\n                    // display a toast to the user\r\n                    ons.notification.toast(`<ons-icon icon=\"md-check\" size=\"20px\" style=\"color: #00D5C3\"></ons-icon> <span style=\"text-transform: capitalize; display: inline-block; margin-left: 1em\">Welcome ${utopiasoftware[utopiasoftware_app_namespace].model.userDetails.userDetails.firstname}</span>`, {timeout:3000});\r\n                }\r\n                catch(err){\r\n                    // display error message indicating that projects data could not be loaded\r\n                    $('#search-project-page .project-data-download-error').css(\"display\", \"block\");\r\n                    $('#determinate-progress-modal').get(0).hide();\r\n                    $('#loader-modal').get(0).hide();\r\n                }\r\n                finally {\r\n                    window.plugins.insomnia.allowSleepAgain(); // the device can go to sleep now\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // adjust the window/view-port settings for when the soft keyboard is displayed\r\n            window.SoftInputMode.set('adjustPan'); // let the window/view-port 'pan' when the soft keyboard is displayed\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            // adjust the window/view-port settings for when the soft keyboard is displayed\r\n            // window.SoftInputMode.set('adjustResize'); // let the view 'resize' when the soft keyboard is displayed\r\n            try {\r\n                // remove any tooltip being displayed on all forms on the page\r\n                $('#search-project-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n                $('#search-project-page [data-hint]').removeAttr(\"data-hint\");\r\n                // reset the form validator object on the page\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.formValidator.reset();\r\n            }\r\n            catch(err){}\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n            // remove any tooltip being displayed on all forms on the page\r\n            $('#search-project-page [data-hint]').removeClass(\"hint--always hint--success hint--medium hint--rounded hint--no-animate\");\r\n            $('#search-project-page [data-hint]').removeAttr(\"data-hint\");\r\n            // reset the form validator object on the page\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.formValidator.destroy();\r\n            // destroy the currently selected project object\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.\r\n                currentlySelectedProject = null;\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the \"Project Search\" button is clicked\r\n         *\r\n         * @returns {Promise<void>}\r\n         */\r\n        async searchButtonClicked(keyEvent){\r\n\r\n            // check which key was pressed\r\n            if(keyEvent.which === kendo.keys.ENTER) // if the enter key was pressed\r\n            {\r\n                // run the validation method for the project search form\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.formValidator.whenValidate();\r\n                keyEvent.preventDefault();\r\n                keyEvent.stopImmediatePropagation();\r\n                keyEvent.stopPropagation();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the download of projects data fails and\r\n         * the user hits the \"Please Retry\" button\r\n         *\r\n         * @returns {Promise<void>}\r\n         */\r\n        async retryProjectDataDownloadButtonClicked(){\r\n\r\n            // hide the page preloader\r\n            $('#search-project-page .page-preloader').css(\"display\", \"none\");\r\n            // hide the previous project details being displayed\r\n            $('#search-project-page #search-project-details').css(\"display\", \"none\");\r\n            // hide all previous error messages (if any)\r\n            $('#search-project-page .no-project-found').css(\"display\", \"none\");\r\n            $('#search-project-page .project-data-download-error').css(\"display\", \"none\");\r\n            // hide the device keyboard\r\n            Keyboard.hide();\r\n\r\n            try {\r\n                // call the method used to load app project data into the persistent database\r\n                await utopiasoftware[utopiasoftware_app_namespace].appCachedData.loadProjectData(true);\r\n                // error the project data download error message\r\n                $('#search-project-page .project-data-download-error').css(\"display\", \"none\");\r\n            }\r\n            catch(err){\r\n                // display the project data download error message\r\n                $('#search-project-page .project-data-download-error').css(\"display\", \"block\");\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the project search search/find form is successfully validated\r\n         * @returns {Promise<void>}\r\n         */\r\n        async formValidated(){\r\n            // show the page preloader\r\n            $('#search-project-page .page-preloader').css(\"display\", \"block\");\r\n            // hide the previous project details being displayed\r\n            $('#search-project-page #search-project-details').css(\"display\", \"none\");\r\n            // hide all previous error messages (if any)\r\n            $('#search-project-page .no-project-found').css(\"display\", \"none\");\r\n            $('#search-project-page .project-data-download-error').css(\"display\", \"none\");\r\n            // hide the bottom toolbar of the page\r\n            $('#search-project-page ons-bottom-toolbar').css(\"display\", \"none\");\r\n\r\n            // hide the device keyboard\r\n            Keyboard.hide();\r\n\r\n            try{\r\n\r\n                // search the app database for the project id provided\r\n                let dbQueryResult = await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.find({\r\n                    selector: {\r\n                        \"PROJECTID\": {\r\n                            \"$eq\": $('#search-project-page #search-project-search-input').get(0).value.trim().toLocaleUpperCase()\r\n                        },\r\n                        \"TYPE\": {\r\n                          \"$eq\": \"projects\"\r\n                        }},\r\n                    fields: [\"_id\", \"_rev\", \"PROJECTID\", \"TITLE\", \"CONTRACTSUM\", \"CONTRACTOR\", \"MDAID\", \"TYPE\"],\r\n                    use_index: [\"ptracker-index-designdoc\", \"FIND_PROJECT_BY_ID_INDEX\"]\r\n                });\r\n\r\n                // check that the requested project was found\r\n                if(dbQueryResult.docs.length == 0){ // search project was NOT FOUND\r\n                    // hide the page preloader\r\n                    $('#search-project-page .page-preloader').css(\"display\", \"none\");\r\n                    // inform user that no project was found\r\n                    $('#search-project-page .no-project-found').css(\"display\", \"block\");\r\n                    // hide the previous project details being displayed\r\n                    $('#search-project-page #search-project-details').css(\"display\", \"none\");\r\n                    // hide all previous error messages\r\n                    $('#search-project-page .project-data-download-error').css(\"display\", \"none\");\r\n                    // hide the bottom toolbar of the page\r\n                    $('#search-project-page ons-bottom-toolbar').css(\"display\", \"none\");\r\n                    return; // exit the method here\r\n                }\r\n\r\n                // if the method gets to this point, it means a project was found\r\n                // assign the searched project object as the currently searched and chosen project object\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.\r\n                    currentlySelectedProject = dbQueryResult.docs[0];\r\n                // create the searched project details to be displayed\r\n                let searchedProjectDetails = `<div class=\"col-xs-6\" style=\"font-weight: bold; color: #000000; padding: 1rem;\">Project ID</div>`;\r\n                searchedProjectDetails += `<div class=\"col-xs-6\" style=\"color: #000000; text-transform: uppercase; padding: 1rem;\">${dbQueryResult.docs[0].PROJECTID}</div>`;\r\n                searchedProjectDetails += `<div class=\"col-xs-6\" style=\"font-weight: bold; color: #000000; padding: 1rem;\">Title</div>`;\r\n                searchedProjectDetails += `<div class=\"col-xs-6\" style=\"color: #000000; text-transform: capitalize; padding: 1rem;\">${dbQueryResult.docs[0].TITLE}</div>`;\r\n                searchedProjectDetails += `<div class=\"col-xs-6\" style=\"font-weight: bold; color: #000000; padding: 1rem;\">Contractor</div>`;\r\n                searchedProjectDetails += `<div class=\"col-xs-6\" style=\"color: #000000; text-transform: capitalize; padding: 1rem;\">${dbQueryResult.docs[0].CONTRACTOR}</div>`;\r\n                searchedProjectDetails += `<div class=\"col-xs-6\" style=\"font-weight: bold; color: #000000; padding: 1rem;\">Contract Sum</div>`;\r\n                searchedProjectDetails += `<div class=\"col-xs-6\" style=\"color: #000000; text-transform: capitalize; padding: 1rem;\">${kendo.toString(kendo.parseFloat(dbQueryResult.docs[0].CONTRACTSUM), \"n2\")}</div>`;\r\n\r\n                // attach the generated project details to the page\r\n                $('#search-project-page #search-project-details').html(searchedProjectDetails);\r\n\r\n                // hide the page preloader\r\n                $('#search-project-page .page-preloader').css(\"display\", \"none\");\r\n\r\n                // perform actions to reveal result\r\n                kendo.fx($('#search-project-page #search-project-details')).fade(\"in\").duration(550).play();\r\n                await Promise.\r\n                resolve(kendo.fx($('#search-project-page ons-bottom-toolbar')).slideIn(\"up\").duration(600).play());\r\n                $('#search-project-page ons-bottom-toolbar').css(\"display\", \"block\");\r\n            }\r\n            catch(err){\r\n                // hide the page preloader\r\n                $('#search-project-page .page-preloader').css(\"display\", \"none\");\r\n                // inform user that no project was found\r\n                $('#search-project-page .no-project-found').css(\"display\", \"block\");\r\n                // hide the previous project details being displayed\r\n                $('#search-project-page #search-project-details').css(\"display\", \"none\");\r\n                // hide the project data download error\r\n                $('#search-project-page .project-data-download-error').css(\"display\", \"none\");\r\n                // hide the bottom toolbar of the page\r\n                $('#search-project-page ons-bottom-toolbar').css(\"display\", \"none\");\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the device back button is clicked OR a similar action is triggered\r\n         */\r\n        backButtonClicked(){\r\n            ons.notification.confirm('Do you want to close the app?', {title: 'Exit App',\r\n                buttonLabels: ['No', 'Yes'], modifier: 'utopiasoftware-alert-dialog'}) // Ask for confirmation\r\n                .then(function(index) {\r\n                    if (index === 1) { // OK button\r\n                        navigator.app.exitApp(); // Close the app\r\n                    }\r\n                });\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the 'Proceed' button is clicked\r\n         */\r\n        proceedButtonClicked(){\r\n\r\n            // move to the project evaluation page. Also pass along the currently chosen project object\r\n            $('#app-main-navigator').get(0).pushPage(\"project-evaluation-page.html\", {animation: \"lift-md\",\r\n            data: {projectData: utopiasoftware[utopiasoftware_app_namespace].controller.searchProjectPageViewModel.\r\n                    currentlySelectedProject}});\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * this is the view-model/controller for the Project Evaluation page\r\n     */\r\n    projectEvaluationPageViewModel: {\r\n\r\n        /**\r\n         * used to hold the parsley form validation object for the page\r\n         */\r\n        formValidator: null,\r\n\r\n        /**\r\n         * used to hold the Viewer object used to display the evaluations snapshots\r\n         */\r\n        pictureViewer: null,\r\n\r\n        /**\r\n         * used to hold the retrieved project milestones\r\n         */\r\n        projectMilestones: null,\r\n\r\n        /**\r\n         * holds the project picturesUrls array.\r\n         * the 1st element of the array is ALWAYS null with subsequent elements holds the url for the pictures\r\n         */\r\n        projectPicturesUrls: [null],\r\n\r\n        /**\r\n         * this property indicates if the picture viewer widget is being displayed or not\r\n         */\r\n        isPictureViewerShowing: false,\r\n\r\n        /**\r\n         * property indicates if project evaluation has commenced on the selected/chosen project.\r\n         * Project evaluation is marked has 'started' if any of the initial states for evaluation is changed by the user\r\n         */\r\n        hasProjectEvaluationStarted: false,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            async function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware[utopiasoftware_app_namespace].model.isAppReady === false\r\n                || !ej || !Viewer){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $('#app-main-navigator').get(0).topPage.onDeviceBackButton =\r\n                    utopiasoftware[utopiasoftware_app_namespace].controller.projectEvaluationPageViewModel.backButtonClicked;\r\n\r\n                // show the page preloader\r\n                $('#project-evaluation-page .page-preloader').css(\"display\", \"block\");\r\n                // hide the items that are not to be displayed\r\n                $('#project-evaluation-page .project-evaluation-instructions, ' +\r\n                    '#project-evaluation-page .content, #project-evaluation-page .no-milestone-found').\r\n                css(\"display\", \"none\");\r\n\r\n                // pick the project data object for which milestones are to be evaluated\r\n                let projectData = $('#app-main-navigator').get(0).topPage.data.projectData;\r\n\r\n                try{\r\n                    // search the app database for milestones using the project id provided\r\n                    let dbQueryResult = await utopiasoftware[utopiasoftware_app_namespace].model.appDatabase.find({\r\n                        selector: {\r\n                            \"PROJECTID\": {\r\n                                \"$eq\": projectData.PROJECTID\r\n                            },\r\n                            \"TYPE\": {\r\n                                \"$eq\": \"BOQ\"\r\n                            }},\r\n                        use_index: [\"ptracker-index-designdoc\", \"FIND_PROJECT_BY_ID_INDEX\"]\r\n                    });\r\n\r\n                    // check if any milestones were returned\r\n                    if(dbQueryResult.docs.length == 0) { // no milestones were found for the project\r\n                        throw \"error\"; // throw an error\r\n                    }\r\n\r\n                    // if the code gets to this point, milestones were returned\r\n                    utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                        projectEvaluationPageViewModel.projectMilestones = dbQueryResult.docs; // update the current project milestones\r\n\r\n                    // create the evaluation carousel item based on the milestones retrieved\r\n                    let carouselContent = \"\";\r\n                    for(let index = 0; index < dbQueryResult.docs.length; index++)\r\n                    {\r\n                        carouselContent = `\r\n                        <ons-carousel-item style=\"overflow-y: auto\">\r\n                            <ons-card>\r\n                                <div style=\"font-size: 1.2em\">\r\n                                    ${dbQueryResult.docs[index].CATEGORY}\r\n                                </div>\r\n                                <div class=\"project-evaluation-slider\"></div>\r\n                                <div class=\"project-evaluation-milestone-amount\" style=\"margin-top: 1em; font-size: 1em;\">\r\n                                    <span style=\"display: inline-block; font-style: italic; margin-right: 1em;\">Milestone Value </span> \r\n                                    ${kendo.toString(kendo.parseFloat(dbQueryResult.docs[index].AMOUNT), \"n2\")}\r\n                                </div>\r\n                                <div class=\"project-evaluation-milestone-current-value\" style=\"font-size: 1em;\">\r\n                                    <span style=\"display: inline-block; font-style: italic; margin-right: 1em;\">Value Completed </span> \r\n                                    ${kendo.toString(kendo.parseFloat(0), \"n2\")}\r\n                                </div>\r\n                            </ons-card>\r\n                        </ons-carousel-item>`;\r\n                        $('#project-evaluation-page #project-evaluation-carousel').append(carouselContent);\r\n                    } // end of for loop\r\n\r\n                    // append the carousel content used for displaying evaluation pictures\r\n                    carouselContent = `\r\n                    <ons-carousel-item style=\"overflow-y: scroll\">\r\n                        <div class=\"row project-evaluation-images-container\" style=\"margin-top: 1.5em;\">\r\n                            <div class=\"col-xs-6\" style=\"padding: 0.5em; position: relative\">\r\n                                <div style=\"position: absolute; top: 5px;\">\r\n                                    <ons-speed-dial id=\"project-evaluation-picture-speed-dial-1\" direction=\"down\">\r\n                                        <ons-fab modifier=\"utopiasoftware-pic-capture-speed-dial\"\r\n                                                 class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                 onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.pictureSpeedDialClicked(1)\">\r\n                                            <ons-icon icon=\"md-image-o\"></ons-icon>\r\n                                        </ons-fab>\r\n                                        <ons-speed-dial-item modifier=\"utopiasoftware-pic-capture-speed-dial-item\"\r\n                                                             class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                             onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.pictureCaptureButtonClicked(1)\">\r\n                                            <ons-icon icon=\"md-camera\"></ons-icon>\r\n                                        </ons-speed-dial-item>\r\n                                        <ons-speed-dial-item modifier=\"utopiasoftware-pic-capture-speed-dial-item\"\r\n                                                             class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                             onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.deletePictureButtonClicked(1)\">\r\n                                            <ons-icon icon=\"md-delete\"></ons-icon>\r\n                                        </ons-speed-dial-item>\r\n                                    </ons-speed-dial>\r\n                                </div>\r\n                                <img id=\"project-evaluation-picture-1\" src=\"css/app-images/project-evaluation-photo-placeholder.png\" style=\"width: 100%; border: 2px darkgray groove\" alt=\"Picture 1\">\r\n                            </div>\r\n                            <div class=\"col-xs-6\" style=\"padding: 0.5em; position: relative\">\r\n                                <div style=\"position: absolute; top: 5px;\">\r\n                                    <ons-speed-dial id=\"project-evaluation-picture-speed-dial-2\" direction=\"down\">\r\n                                        <ons-fab modifier=\"utopiasoftware-pic-capture-speed-dial\"\r\n                                                 class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                 onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.pictureSpeedDialClicked(2)\">\r\n                                            <ons-icon icon=\"md-image-o\"></ons-icon>\r\n                                        </ons-fab>\r\n                                        <ons-speed-dial-item modifier=\"utopiasoftware-pic-capture-speed-dial-item\"\r\n                                                             class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                             onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.pictureCaptureButtonClicked(2)\">\r\n                                            <ons-icon icon=\"md-camera\"></ons-icon>\r\n                                        </ons-speed-dial-item>\r\n                                        <ons-speed-dial-item modifier=\"utopiasoftware-pic-capture-speed-dial-item\"\r\n                                                             class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                             onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.deletePictureButtonClicked(2)\">\r\n                                            <ons-icon icon=\"md-delete\"></ons-icon>\r\n                                        </ons-speed-dial-item>\r\n                                    </ons-speed-dial>\r\n                                </div>\r\n                                <img id=\"project-evaluation-picture-2\" src=\"css/app-images/project-evaluation-photo-placeholder.png\" style=\"width: 100%; border: 2px darkgray groove\" alt=\"Picture 2\">\r\n                            </div>\r\n                            <div class=\"col-xs-offset-3 col-xs-6\" style=\"padding: 0.5em; position: relative\">\r\n                                <div style=\"position: absolute; top: 5px;\">\r\n                                    <ons-speed-dial id=\"project-evaluation-picture-speed-dial-3\" direction=\"down\">\r\n                                        <ons-fab modifier=\"utopiasoftware-pic-capture-speed-dial\"\r\n                                                 class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                 onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.pictureSpeedDialClicked(3)\">\r\n                                            <ons-icon icon=\"md-image-o\"></ons-icon>\r\n                                        </ons-fab>\r\n                                        <ons-speed-dial-item modifier=\"utopiasoftware-pic-capture-speed-dial-item\"\r\n                                                             class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                             onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.pictureCaptureButtonClicked(3)\">\r\n                                            <ons-icon icon=\"md-camera\"></ons-icon>\r\n                                        </ons-speed-dial-item>\r\n                                        <ons-speed-dial-item modifier=\"utopiasoftware-pic-capture-speed-dial-item\"\r\n                                                             class=\"utopiasoftware-pic-capture-speed-dial\" \r\n                                                             onclick=\"utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                                 projectEvaluationPageViewModel.deletePictureButtonClicked(3)\">\r\n                                            <ons-icon icon=\"md-delete\"></ons-icon>\r\n                                        </ons-speed-dial-item>\r\n                                    </ons-speed-dial>\r\n                                </div>\r\n                                <img id=\"project-evaluation-picture-3\" src=\"css/app-images/project-evaluation-photo-placeholder.png\" style=\"width: 100%; border: 2px darkgray groove\" alt=\"Picture 3\">\r\n                            </div>\r\n                        </div>\r\n                    </ons-carousel-item>`;\r\n\r\n                    // append the generated carousel content to the project evaluation carousel\r\n                    $('#project-evaluation-page #project-evaluation-carousel').append(carouselContent);\r\n\r\n                    // create the project evaluation slider elements\r\n                    $('#project-evaluation-page .project-evaluation-slider').\r\n                    each(function(index, element){\r\n                        element._ptracker_index = index;\r\n                        element._ptracker_\r\n                        let aSlider = new ej.inputs.Slider({\r\n                            min: 0,\r\n                            max: 100,\r\n                            value: 0,\r\n                            step: 1,\r\n                            orientation: 'Horizontal',\r\n                            type: 'MinRange',\r\n                            created: function(){\r\n                                $('.e-handle', element).text(this.value);\r\n                            },\r\n                            change: function(changeEvent){\r\n                                $('.e-handle', element).text(changeEvent.value);\r\n                                // update the project evaluation started flag to indicate evaluation has started\r\n                                utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                    projectEvaluationPageViewModel.hasProjectEvaluationStarted = true;\r\n                            },\r\n                            changed: function(changedEvent){\r\n                                console.log(\"INSIDE EVENT\");\r\n                                console.log(\"SLIDER VALUE\", changedEvent.value);\r\n                                console.log(\"SLIDER VALUE\", this.value);\r\n                                console.log(\"MILESTONE VALUE\", dbQueryResult.docs[index].AMOUNT);\r\n                                $(`#project-evaluation-page .e-slider-container:nth-of-type(${element._ptracker_index + 1}) ~ .project-evaluation-milestone-current-value`)\r\n                                    .html(`<span style=\"display: inline-block; font-style: italic; margin-right: 1em;\">Value Completed *</span> \r\n                                    ${kendo.toString(kendo.parseFloat((changedEvent.value / 100) * kendo.parseFloat(dbQueryResult.docs[element._ptracker_index].AMOUNT)), \"n2\")}`);\r\n                            }\r\n                        });\r\n                        aSlider.appendTo(element);\r\n                    });\r\n\r\n                    // create the Viewer widget used to view the project evaluation photos\r\n                    utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                        projectEvaluationPageViewModel.pictureViewer =\r\n                        new Viewer($('#project-evaluation-page .project-evaluation-images-container').get(0),\r\n                            {inline: false,\r\n                                toolbar: {\r\n                                    prev: {\r\n                                        show: true,\r\n                                        size: 'large',\r\n                                    },\r\n                                    next: {\r\n                                        show: true,\r\n                                        size: 'large',\r\n                                    },\r\n                                    zoomIn: {\r\n                                        show: true,\r\n                                        size: 'large',\r\n                                    },\r\n                                    zoomOut: {\r\n                                        show: true,\r\n                                        size: 'large',\r\n                                    },\r\n                                    oneToOne: {\r\n                                        show: true,\r\n                                        size: 'large',\r\n                                    },\r\n                                    reset: {\r\n                                        show: true,\r\n                                        size: 'large',\r\n                                    },\r\n                                    play: {\r\n                                        show: false,\r\n                                        size: 'large',\r\n                                    },\r\n                                    rotateLeft: {\r\n                                        show: false,\r\n                                        size: 'large',\r\n                                    },\r\n                                    rotateRight: {\r\n                                        show: false,\r\n                                        size: 'large',\r\n                                    },\r\n                                    flipHorizontal: {\r\n                                        show: false,\r\n                                        size: 'large',\r\n                                    },\r\n                                    flipVertical: {\r\n                                        show: false,\r\n                                        size: 'large',\r\n                                    }\r\n                                },\r\n                                backdrop: 'static',\r\n                                shown: function(){ // event is triggered when Picture Viewer is shown\r\n                                    // indicate that the picture viewer widget is showing\r\n                                    utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                        projectEvaluationPageViewModel.isPictureViewerShowing == true;\r\n                                },\r\n                                hidden: function(){ // event is triggered when Picture Viewer is hidden\r\n                                    // indicate that the picture viewer widget is hidden\r\n                                    utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                                        projectEvaluationPageViewModel.isPictureViewerShowing == false;\r\n                                }});\r\n\r\n                    // hide the page preloader\r\n                    $('#project-evaluation-page .page-preloader').css(\"display\", \"none\");\r\n                    // show the items that are to be displayed\r\n                    $('#project-evaluation-page .project-evaluation-instructions, #project-evaluation-page .content').\r\n                    css(\"display\", \"block\");\r\n                    $('#project-evaluation-page #project-evaluation-next-button').\r\n                    css(\"display\", \"inline-block\");\r\n                }\r\n                catch (e) {\r\n                    // hide the page preloader\r\n                    $('#project-evaluation-page .page-preloader').css(\"display\", \"none\");\r\n                    // hide the items that are not to be displayed\r\n                    $('#project-evaluation-page .project-evaluation-instructions, #project-evaluation-page .content').\r\n                    css(\"display\", \"none\");\r\n                    $('#project-evaluation-page #project-evaluation-prev-button, #project-evaluation-page #project-evaluation-next-button').\r\n                    css(\"display\", \"none\");\r\n                    // display the message to inform user that there are no milestones available for the project\r\n                    $('#project-evaluation-page .no-milestone-found').css(\"display\", \"block\");\r\n                }\r\n                finally{\r\n                    // hide the loader\r\n                    $('#loader-modal').get(0).hide();\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // adjust the window/view-port settings for when the soft keyboard is displayed\r\n            window.SoftInputMode.set('adjustPan'); // let the window/view-port 'pan' when the soft keyboard is displayed\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            // adjust the window/view-port settings for when the soft keyboard is displayed\r\n            // window.SoftInputMode.set('adjustResize'); // let the view 'resize' when the soft keyboard is displayed\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is destroyed\r\n         */\r\n        pageDestroy: function(){\r\n            // destroy the pictures Viewer widget instance\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.pictureViewer.destroy();\r\n            // reset other object properties\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectMilestones = null;\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectPicturesUrls = [null];\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.hasProjectEvaluationStarted = false;\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the device back button is clicked OR a similar action is triggered\r\n         */\r\n        async backButtonClicked(){\r\n\r\n            // check if the Picture Viewer widget is showing\r\n            if(utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.isPictureViewerShowing === true){ // Picture Viewer is showing\r\n                // hide it\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                    projectEvaluationPageViewModel.pictureViewer.hide();\r\n                return; // exit\r\n            }\r\n\r\n            // check if project evaluation has already started\r\n           if(// update the project evaluation started flag to indicate evaluation has started\r\n               utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                   projectEvaluationPageViewModel.hasProjectEvaluationStarted === true){ // evaluation has started\r\n\r\n               // inform user that leaving this page will mean that current evaluation data is lost. does user want to leave?\r\n               let leaveProjectEvaluation = await ons.notification.confirm('',\r\n                   {title: '<ons-icon icon=\"md-alert-triangle\" style=\"color: #3f51b5\" size=\"33px\"></ons-icon> <span style=\"color: #3f51b5; display: inline-block; margin-left: 1em;\">Warning</span>',\r\n                       messageHTML: `You have NOT completed the evaluation. If you leave now, all evaluation data will be cancelled.<br><br> Do you want to leave the project evaluation?`,\r\n                       buttonLabels: ['No', 'Yes'], modifier: 'utopiasoftware-alert-dialog'});\r\n\r\n               if(leaveProjectEvaluation == 0){ // user does not want to project evaluation, so exit method now\r\n                   return; // exit method\r\n               }\r\n           }\r\n\r\n            // move to the project evaluation page\r\n            $('#app-main-navigator').get(0).popPage();\r\n        },\r\n\r\n        /**\r\n         * method is used to control the behaviour of the picture speed dials\r\n         *\r\n         * @param pictureNumber {Integer} holds the number/position of the picture.\r\n         * The position of pictures starts from 1 (i.e. 1-based counting)\r\n         */\r\n        pictureSpeedDialClicked(pictureNumber){\r\n\r\n            // handler conditions for each picture speed-dial\r\n            switch(pictureNumber){ // determine what to do based on the picture number value\r\n\r\n                case 1:\r\n                    // check if the speed-dial widget that was clicked is currently opened\r\n                    if(!$('#project-evaluation-page #project-evaluation-picture-speed-dial-1').get(0).isOpen()){ // speed-dial is open\r\n                        // close all other picture speed-dials\r\n                        $('#project-evaluation-page #project-evaluation-picture-speed-dial-2').get(0).hideItems();\r\n                        $('#project-evaluation-page #project-evaluation-picture-speed-dial-3').get(0).hideItems();\r\n                    }\r\n                    break;\r\n\r\n                case 2:\r\n                    if(!$('#project-evaluation-page #project-evaluation-picture-speed-dial-2').get(0).isOpen()){ // speed-dial is open\r\n                        // close all other picture speed-dials\r\n                        $('#project-evaluation-page #project-evaluation-picture-speed-dial-1').get(0).hideItems();\r\n                        $('#project-evaluation-page #project-evaluation-picture-speed-dial-3').get(0).hideItems();\r\n                    }\r\n                    break;\r\n\r\n                case 3:\r\n                    if(!$('#project-evaluation-page #project-evaluation-picture-speed-dial-3').get(0).isOpen()){ // speed-dial is open\r\n                        // close all other picture speed-dials\r\n                        $('#project-evaluation-page #project-evaluation-picture-speed-dial-1').get(0).hideItems();\r\n                        $('#project-evaluation-page #project-evaluation-picture-speed-dial-2').get(0).hideItems();\r\n                    }\r\n                    break;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is used to capture project evaluation photos with the user's camera\r\n         *\r\n         * @param pictureNumber {Integer} holds the number/position of the picture.\r\n         * The position of pictures starts from 1 (i.e. 1-based counting)\r\n         */\r\n        async pictureCaptureButtonClicked(pictureNumber){\r\n\r\n            var permissionStatuses = null; // holds the statuses of the runtime permissions requested\r\n\r\n            try{\r\n                // request runtime permissions to use device's camera\r\n                permissionStatuses =  await new Promise(function(resolve, reject){\r\n                    cordova.plugins.diagnostic.requestRuntimePermissions(resolve, reject,[\r\n                        cordova.plugins.diagnostic.permission.CAMERA\r\n                    ]);\r\n                });\r\n\r\n                // check if the user has given permission to use the device's camera\r\n                if((!permissionStatuses) ||\r\n                    permissionStatuses[cordova.plugins.diagnostic.permission.CAMERA] !==\r\n                    cordova.plugins.diagnostic.permissionStatus.GRANTED){\r\n                    throw \"error - no runtime permissions\";\r\n                }\r\n\r\n                // disable screen orientation lock\r\n                screen.orientation.unlock();\r\n\r\n                // open the device camera app and capture a photo\r\n                let imageUrl = await new Promise(function(resolve, reject){\r\n                    navigator.camera.getPicture(resolve, reject, {\r\n                        quality: 70,\r\n                        destinationType: Camera.DestinationType.FILE_URI,\r\n                        sourceType: Camera.PictureSourceType.CAMERA,\r\n                        allowEdit: false,\r\n                        encodingType: Camera.EncodingType.JPEG,\r\n                        correctOrientation: false,\r\n                        saveToPhotoAlbum: false,\r\n                        cameraDirection: Camera.Direction.BACK\r\n                    });\r\n                });\r\n\r\n                // check what picture number the camera was used for and then display it\r\n                switch(pictureNumber){\r\n                    case 1:\r\n                        // store the image url in the correct picturesUrls array index\r\n                        utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                            projectEvaluationPageViewModel.projectPicturesUrls[pictureNumber] = imageUrl;\r\n                        // update the image src for the correct project picture, so that picture can be displayed\r\n                        $('#project-evaluation-page #project-evaluation-picture-1').attr(\"src\", imageUrl);\r\n                        break;\r\n\r\n                    case 2:\r\n                        // store the image url in the correct picturesUrls array index\r\n                        utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                            projectEvaluationPageViewModel.projectPicturesUrls[pictureNumber] = imageUrl;\r\n                        // update the image src for the correct project picture, so that picture can be displayed\r\n                        $('#project-evaluation-page #project-evaluation-picture-2').attr(\"src\", imageUrl);\r\n                        break;\r\n\r\n                    case 3:\r\n                        // store the image url in the correct picturesUrls array index\r\n                        utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                            projectEvaluationPageViewModel.projectPicturesUrls[pictureNumber] = imageUrl;\r\n                        // update the image src for the correct project picture, so that picture can be displayed\r\n                        $('#project-evaluation-page #project-evaluation-picture-3').attr(\"src\", imageUrl);\r\n                        break;\r\n                }\r\n\r\n                // update the project evaluation started flag to indicate evaluation has started\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                    projectEvaluationPageViewModel.hasProjectEvaluationStarted = true;\r\n\r\n                // update the picture viewer widget\r\n                utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                    projectEvaluationPageViewModel.pictureViewer.update();\r\n            }\r\n            catch(err){\r\n                // in form the user of the error\r\n                window.plugins.toast.showWithOptions({\r\n                    message: \"Photo Capture Failed - \" + err,\r\n                    duration: 4000,\r\n                    position: \"top\",\r\n                    styling: {\r\n                        opacity: 1,\r\n                        backgroundColor: '#ff0000', //red\r\n                        textColor: '#FFFFFF',\r\n                        textSize: 14\r\n                    }\r\n                }, function(toastEvent){\r\n                    if(toastEvent && toastEvent.event == \"touch\"){ // user tapped the toast, so hide toast immediately\r\n                        window.plugins.toast.hide();\r\n                    }\r\n                });\r\n            }\r\n            finally {\r\n                // lock the device orientation back to 'portrait'\r\n                screen.orientation.lock('portrait');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * method is used to delete/remove project evaluation photos from the collection and display\r\n         *\r\n         * @param pictureNumber {Integer} holds the number/position of the picture.\r\n         * The position of pictures starts from 1 (i.e. 1-based counting)\r\n         */\r\n        async deletePictureButtonClicked(pictureNumber){\r\n\r\n            // check if the selected photo has been changed from the default (no photo)\r\n            if(! utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectPicturesUrls[pictureNumber]){ // the photo is in the default\r\n                // since the photo is in the default, there is no need to delete photo. so exit\r\n                return; // exit\r\n            }\r\n\r\n            // ask user to confirm photo delete\r\n            let deletePhoto = await ons.notification.confirm('Do you want to delete the photo?',\r\n                {title: '<ons-icon icon=\"md-delete\" style=\"color: #3f51b5\" size=\"33px\"></ons-icon> <span style=\"color: #3f51b5; display: inline-block; margin-left: 1em;\">Delete Photo</span>',\r\n                buttonLabels: ['No', 'Yes'], modifier: 'utopiasoftware-alert-dialog'});\r\n\r\n            if(deletePhoto == 0){ // user does not want to delete photo, so exit method now\r\n                return; // exit method\r\n            }\r\n\r\n            // remove the image url in the correct picturesUrls array index\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectPicturesUrls[pictureNumber] = null;\r\n            // update the image src to the \"no photo\" display\r\n            $('#project-evaluation-page #project-evaluation-picture-' + pictureNumber).\r\n            attr(\"src\", \"css/app-images/project-evaluation-photo-placeholder.png\");\r\n\r\n            // update the picture viewer widget\r\n            utopiasoftware[utopiasoftware_app_namespace].controller.\r\n            projectEvaluationPageViewModel.pictureViewer.update();\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the \"project evaluation carousel\" is changed\r\n         * @param event\r\n         */\r\n        carouselChanged(event){\r\n            // change the css display the prev fab button\r\n            $('#project-evaluation-page #project-evaluation-prev-button').css(\"display\", \"inline-block\");\r\n\r\n            // update the stay of the the fab \"prev\" or \"next\" buttons\r\n             // check if the carousel is at the last item\r\n            if(event.originalEvent.activeIndex ===\r\n                event.originalEvent.carousel.itemCount - 1) { // this is the last carousel item, so hide the next slide button\r\n                // hide the next fab button\r\n                $('#project-evaluation-page #project-evaluation-next-button').css(\"transform\", \"scale(0)\");\r\n            }\r\n            else if(event.originalEvent.activeIndex === 0) { // this is the first carousel item, so hide the prev slide button\r\n                // hide the prev fab button\r\n                $('#project-evaluation-page #project-evaluation-prev-button').css(\"transform\", \"scale(0)\");\r\n            }\r\n            else { // this is not the first or last item\r\n                $('#project-evaluation-page #project-evaluation-prev-button,#project-evaluation-page #project-evaluation-next-button')\r\n                    .css(\"transform\", \"scale(1)\");\r\n            }\r\n\r\n            // update the primary instruction and the milestone badge\r\n            if(event.originalEvent.activeIndex < utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectMilestones.length) // the carousel active index is less than the number of project milestones\r\n            {\r\n                // change the primary instructions\r\n                $('#project-evaluation-page #project-evaluation-primary-instruction').\r\n                html('Evaluate the milestones of project completion on a scale of 0 - 100%');\r\n                // change the milestone number\r\n                $('#project-evaluation-page #project-evaluation-milestone-badge').html(`Milestone ${event.originalEvent.activeIndex + 1}`);\r\n                return;\r\n            }\r\n            if(event.originalEvent.activeIndex == utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectMilestones.length) // the carousel active index is at the picture capture point\r\n            {\r\n                // change the primary instructions\r\n                $('#project-evaluation-page #project-evaluation-primary-instruction').\r\n                html('Capture the project progress in photos');\r\n                // change the milestone number\r\n                $('#project-evaluation-page #project-evaluation-milestone-badge').html(`Project Photos`);\r\n                return;\r\n            }\r\n            if(event.originalEvent.activeIndex == utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectMilestones.length + 1) // the carousel active index is at the geolocation capture point\r\n            {\r\n                // change the primary instructions\r\n                $('#project-evaluation-page #project-evaluation-primary-instruction').\r\n                html('Capture the project geographical location');\r\n                // change the milestone number\r\n                $('#project-evaluation-page #project-evaluation-milestone-badge').html(`Project Location`);\r\n                return;\r\n            }\r\n            if(event.originalEvent.activeIndex == utopiasoftware[utopiasoftware_app_namespace].controller.\r\n                projectEvaluationPageViewModel.projectMilestones.length + 2) // the carousel active index is at the project remarks point\r\n            {\r\n                // change the primary instructions\r\n                $('#project-evaluation-page #project-evaluation-primary-instruction').\r\n                html('Provide any remarks on the project evaluation (optional)');\r\n                // change the milestone number\r\n                $('#project-evaluation-page #project-evaluation-milestone-badge').html(`Project Evaluation Remarks`);\r\n                return;\r\n            }\r\n\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when the \"prev button\" for the carousel is clicked\r\n         */\r\n        prevButtonClicked(){\r\n            $('#project-evaluation-page #project-evaluation-carousel').get(0).prev();\r\n        },\r\n\r\n        /**\r\n         * method is triggered when the \"next button\" for the carousel is clicked\r\n         */\r\n        nextButtonClicked(){\r\n            $('#project-evaluation-page #project-evaluation-carousel').get(0).next();\r\n        }\r\n\r\n    }\r\n};\r\n\r\n\r\n"]}